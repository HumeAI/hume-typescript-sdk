// This file was auto-generated by Fern from our API Definition.

import * as core from '../core/index.js';
import * as errors from '../errors/index.js';

export namespace HeaderAuthProvider {
  export interface Options {
    apiKey?: core.Supplier<string | undefined>;
  }
}

export class HeaderAuthProvider implements core.AuthProvider {
  private readonly headerValue: core.Supplier<string | undefined>;

  constructor(options: HeaderAuthProvider.Options) {
    this.headerValue = options.apiKey;
  }

  public static canCreate(options: HeaderAuthProvider.Options): boolean {
    return options.apiKey != null;
  }

  public async getAuthRequest(_arg?: {
    endpointMetadata?: core.EndpointMetadata;
  }): Promise<core.AuthRequest> {
    const apiKey = await core.Supplier.get(this.headerValue);
    if (apiKey == null) {
      throw new errors.HumeError({
        message: 'Please specify a apiKey by passing it in to the constructor',
      });
    }

    const headerValue = apiKey;

    return {
      headers: { 'X-Hume-Api-Key': headerValue },
    };
  }
}
